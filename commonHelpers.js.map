{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport axios from 'axios';\nconst refs = {\n  form: document.querySelector('.img-form'),\n  inputForm: document.querySelector('.img-inp'),\n  btnForm: document.querySelector('.img-btn'),\n  galleryForm: document.querySelector('.gallery'),\n  loaderForm: document.querySelector('.loader'),\n  loadMoreBtn: document.querySelector('.load-btn'),\n};\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '41930626-f2ac102ea6260ef01eb19ab27';\n\nconst simplyGallery = new SimpleLightbox('.gallery-item a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\nconst hiddenClass = 'is-hidden';\nlet page = 1;\nlet query = '';\nlet maxPage = 0;\n\nrefs.form.addEventListener('submit', searchForm);\n\nasync function searchForm(event) {\n  event.preventDefault();\n  refs.galleryForm.innerHTML = '';\n  showLoader(true);\n  page = 1;\n  refs.loadMoreBtn.classList.add(hiddenClass);\n  query = refs.form.query.value.trim();\n\n  if (!query) {\n    showLoader(false);\n    createMessage(\n      `The search field can't be empty! Please, enter your request!`\n    );\n    return;\n  }\n  try {\n    const data = await fetchImages(query);\n\n    maxPage = Math.ceil(data.totalHits / 40);\n\n    createMarkup(data.hits, refs.galleryForm);\n\n    if (data.hits.length > 0) {\n      refs.loadMoreBtn.classList.remove(hiddenClass);\n      refs.loadMoreBtn.addEventListener('click', onLoadMore);\n    } else {\n      refs.loadMoreBtn.classList.add(hiddenClass);\n      createMessage(\n        `Sorry, there are no images matching your search query. Please, try again!`\n      );\n    }\n    showLoader(false);\n  } catch (error) {\n    console.log(error);\n  } finally {\n    refs.form.reset();\n    if (page === maxPage) {\n      refs.loadMoreBtn.classList.add(hiddenClass);\n    }\n  }\n}\n\nfunction createMessage(message) {\n  iziToast.show({\n    class: 'error-svg',\n    position: 'topRight',\n    icon: 'error-svg',\n    message: message,\n    maxWidth: '432',\n    messageColor: '#fff',\n    messageSize: '16px',\n    backgroundColor: '#EF4040',\n    close: false,\n    closeOnClick: true,\n  });\n}\nasync function onLoadMore() {\n  page += 1;\n  try {\n    showLoader(true);\n    refs.loadMoreBtn.classList.add(hiddenClass);\n    const { hits } = await fetchImages(query, page);\n    createMarkup(hits);\n    showLoader(false);\n    simplyGallery.refresh();\n    refs.loadMoreBtn.classList.remove(hiddenClass);\n  } catch (error) {\n    console.log(error);\n  } finally {\n    if (page === maxPage) {\n      refs.loadMoreBtn.classList.add(hiddenClass);\n    }\n  }\n}\nasync function fetchImages(query, page = 1) {\n  const response = await axios.get(`${BASE_URL}`, {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: 40,\n      page: page,\n    },\n  });\n  return response.data;\n}\n\nfunction createMarkup(hits) {\n  const markup = hits\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `\n       <li class=\"gallery-item\">\n  <a class=\"gallery-link\" href=\"${largeImageURL}\">\n    <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n    <p class=\"gallery-item\">Likes: ${likes} Views: ${views} Comments: ${comments} Downloads: ${downloads}</p>\n  </a>\n</li>`\n    )\n    .join('');\n  refs.galleryForm.insertAdjacentHTML('beforeend', markup);\n  simplyGallery.refresh();\n}\n\nfunction showLoader(state = true) {\n  refs.loaderForm.style.display = !state ? 'none' : 'inline-block';\n  refs.btnForm.disabled = state;\n}\n"],"names":["refs","BASE_URL","API_KEY","simplyGallery","SimpleLightbox","hiddenClass","page","query","maxPage","searchForm","event","showLoader","createMessage","data","fetchImages","createMarkup","onLoadMore","error","message","iziToast","hits","axios","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","state"],"mappings":"owBAOA,MAAMA,EAAO,CACX,KAAM,SAAS,cAAc,WAAW,EACxC,UAAW,SAAS,cAAc,UAAU,EAC5C,QAAS,SAAS,cAAc,UAAU,EAC1C,YAAa,SAAS,cAAc,UAAU,EAC9C,WAAY,SAAS,cAAc,SAAS,EAC5C,YAAa,SAAS,cAAc,WAAW,CACjD,EAEMC,EAAW,2BACXC,EAAU,qCAEVC,EAAgB,IAAIC,EAAe,kBAAmB,CAC1D,aAAc,MACd,aAAc,GAChB,CAAC,EACKC,EAAc,YACpB,IAAIC,EAAO,EACPC,EAAQ,GACRC,EAAU,EAEdR,EAAK,KAAK,iBAAiB,SAAUS,CAAU,EAE/C,eAAeA,EAAWC,EAAO,CAQ/B,GAPAA,EAAM,eAAc,EACpBV,EAAK,YAAY,UAAY,GAC7BW,EAAW,EAAI,EACfL,EAAO,EACPN,EAAK,YAAY,UAAU,IAAIK,CAAW,EAC1CE,EAAQP,EAAK,KAAK,MAAM,MAAM,KAAI,EAE9B,CAACO,EAAO,CACVI,EAAW,EAAK,EAChBC,EACE,8DACN,EACI,MACD,CACD,GAAI,CACF,MAAMC,EAAO,MAAMC,EAAYP,CAAK,EAEpCC,EAAU,KAAK,KAAKK,EAAK,UAAY,EAAE,EAEvCE,EAAaF,EAAK,KAAMb,EAAK,WAAW,EAEpCa,EAAK,KAAK,OAAS,GACrBb,EAAK,YAAY,UAAU,OAAOK,CAAW,EAC7CL,EAAK,YAAY,iBAAiB,QAASgB,CAAU,IAErDhB,EAAK,YAAY,UAAU,IAAIK,CAAW,EAC1CO,EACE,2EACR,GAEID,EAAW,EAAK,CACjB,OAAQM,EAAP,CACA,QAAQ,IAAIA,CAAK,CACrB,QAAY,CACRjB,EAAK,KAAK,QACNM,IAASE,GACXR,EAAK,YAAY,UAAU,IAAIK,CAAW,CAE7C,CACH,CAEA,SAASO,EAAcM,EAAS,CAC9BC,EAAS,KAAK,CACZ,MAAO,YACP,SAAU,WACV,KAAM,YACN,QAASD,EACT,SAAU,MACV,aAAc,OACd,YAAa,OACb,gBAAiB,UACjB,MAAO,GACP,aAAc,EAClB,CAAG,CACH,CACA,eAAeF,GAAa,CAC1BV,GAAQ,EACR,GAAI,CACFK,EAAW,EAAI,EACfX,EAAK,YAAY,UAAU,IAAIK,CAAW,EAC1C,KAAM,CAAE,KAAAe,CAAI,EAAK,MAAMN,EAAYP,EAAOD,CAAI,EAC9CS,EAAaK,CAAI,EACjBT,EAAW,EAAK,EAChBR,EAAc,QAAO,EACrBH,EAAK,YAAY,UAAU,OAAOK,CAAW,CAC9C,OAAQY,EAAP,CACA,QAAQ,IAAIA,CAAK,CACrB,QAAY,CACJX,IAASE,GACXR,EAAK,YAAY,UAAU,IAAIK,CAAW,CAE7C,CACH,CACA,eAAeS,EAAYP,EAAOD,EAAO,EAAG,CAY1C,OAXiB,MAAMe,EAAM,IAAI,GAAGpB,IAAY,CAC9C,OAAQ,CACN,IAAKC,EACL,EAAGK,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAMD,CACP,CACL,CAAG,GACe,IAClB,CAEA,SAASS,EAAaK,EAAM,CAC1B,MAAME,EAASF,EACZ,IACC,CAAC,CACC,aAAAG,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACD,IACC;AAAA;AAAA,kCAE0BL;AAAA,sCACID,WAAsBE;AAAA,qCACvBC,YAAgBC,eAAmBC,gBAAuBC;AAAA;AAAA,MAG1F,EACA,KAAK,EAAE,EACV7B,EAAK,YAAY,mBAAmB,YAAasB,CAAM,EACvDnB,EAAc,QAAO,CACvB,CAEA,SAASQ,EAAWmB,EAAQ,GAAM,CAChC9B,EAAK,WAAW,MAAM,QAAW8B,EAAiB,eAAT,OACzC9B,EAAK,QAAQ,SAAW8B,CAC1B"}